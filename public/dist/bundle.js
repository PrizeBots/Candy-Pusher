(()=>{"use strict";class t{constructor(t,e){this.engine=t,this.canvas=e,this.scene=new BABYLON.Scene(t),this.scene.enablePhysics(new BABYLON.Vector3(0,-50,0),new BABYLON.CannonJSPlugin),this._setupLighting(),this._setupCamera(),this.cameraLocked=!0,this.camera}cameraLock(){console.log("camera lock"),this.cameraLocked?(this.cameraLocked=!1,this.camera.attachControl(this.canvas,!0)):(this.cameraLocked=!0,this.camera.detachControl(this.canvas))}_setupLighting(){new BABYLON.HemisphericLight("light",new BABYLON.Vector3(0,.9,0),this.scene).intensity=.85}_setupCamera(){var t=new BABYLON.ArcRotateCamera("camera1",Math.PI/2,Math.PI/2.8,200,new BABYLON.Vector3(0,0,0),this.scene);t.target.y=-22,t.fov=.7,t.aspectRatio=this.canvas.width/this.canvas.height,this.camera=t}getScene(){return this.scene}}class e{constructor(t){this.scene=t,this.wallMaterial=null,this.pusherMaterial=null,this.coinMaterials={},this.objectMaterials={},this._createMaterials()}_createMaterials(){this.collisionBoxMaterial=new BABYLON.StandardMaterial("collisionBoxMaterial",this.scene),this.collisionBoxMaterial.diffuseColor=new BABYLON.Color3(.196,.784,.196),this.wallMaterial=new BABYLON.StandardMaterial("wallMaterial",this.scene),this.wallMaterial.diffuseColor=new BABYLON.Color3(0,.31,.31),this.pusherMaterial=new BABYLON.StandardMaterial("pusherMaterial",this.scene),this.pusherMaterial.diffuseColor=new BABYLON.Color3(2,.31,.31),this.coinMaterials.gold=new BABYLON.StandardMaterial("coinGoldMat",this.scene),this.coinMaterials.gold.diffuseColor=new BABYLON.Color3(1,.843,0),this.coinMaterials.red=new BABYLON.StandardMaterial("coinRedMat",this.scene),this.coinMaterials.red.diffuseColor=new BABYLON.Color3(1,0,0),this.coinMaterials.blue=new BABYLON.StandardMaterial("coinBlueMat",this.scene),this.coinMaterials.blue.diffuseColor=new BABYLON.Color3(0,0,1),this.objectMaterials.donut=new BABYLON.StandardMaterial("donut",this.scene),this.objectMaterials.donut.diffuseColor=new BABYLON.Color3(1,.5,.5)}getMaterial(t){return this.coinMaterials[t]?this.coinMaterials[t]:this.objectMaterials[t]?this.objectMaterials[t]:"wallMaterial"===t?this.wallMaterial:"pusherMaterial"===t?this.pusherMaterial:"collisionBoxMaterial"===t?this.collisionBoxMaterial:null}}class o{constructor(t){this.game=t,this.bonusWindowActive=!1,this.bonusWindowTimer=null,this.bonusCount=0,this.getTreat=!1,this.init()}init(){}checkGoal(t){this.handleBonusWindow();var e=t.name;"cookieCylinder"===e?(this.game.score++,this.bonusCount++,this.game.cookieCount++,this.game.uiManager.updateCookieCounter()):"cupcakeCylinder"===e?(this.game.cupcakeCount+=1,this.getTreat=!0,this.game.score+=2,this.bonusCount+=2,this.game.uiManager.updateCupcakeCounter()):"donutCylinder"===e?(this.game.donutCount+=1,this.getTreat=!0,this.game.score+=4,this.bonusCount+=4,this.game.uiManager.updateDonutCounter()):"chocolateBarBox"===e?(this.game.chocolateCount+=1,this.getTreat=!0,this.game.score+=8,this.bonusCount+=8,this.game.uiManager.updateChocolateCounter()):"pie"===e?(this.game.pieCount+=1,this.getTreat=!0,this.game.score+=16,this.bonusCount+=8,this.game.uiManager.updatePieCounter()):console.log("goalPlane ?????s ",e),1===this.bonusCount?this.game.get1Sound.play():2===this.bonusCount?this.game.get2Sound.play():3===this.bonusCount?this.game.get3Sound.play():4===this.bonusCount?this.game.get4Sound.play():5===this.bonusCount?this.game.get5Sound.play():6===this.bonusCount?this.game.get6Sound.play():7===this.bonusCount?this.game.get7Sound.play():8===this.bonusCount?this.game.get8Sound.play():9===this.bonusCount?this.game.get9Sound.play():10===this.bonusCount&&this.game.get10Sound.play(),this.getTreat&&(this.getTreat=!1,this.game.getTreatSound.play()),t.dispose(),this.game.uiManager.updateScore()}handleBonusWindow(){console.log("handleBonusWindow"),this.bonusWindowActive||(this.bonusWindowActive=!0,this.bonusCount=0,this.bonusWindowTimer=setTimeout((()=>{console.log(`Bonus value: ${this.bonusCount}`),this.handleDropRewards(),this.bonusWindowActive=!1}),2e3))}handleDropRewards(){if(this.bonusCount>1&&this.bonusCount<=3){var t=new BABYLON.Vector3(0,40,0);this.game.dropManager.dropCookie(!1,t),this.game.dropTreatSound.play()}else this.bonusCount>3&&this.bonusCount<=5?(this.game.dropManager.dropCupcake(),this.game.dropTreat2Sound.play()):this.bonusCount>=6&&this.bonusCount<8?(this.game.dropManager.dropDonut(),this.game.dropTreat2Sound.play()):this.bonusCount>=7&&this.bonusCount<10?(this.game.dropManager.dropCupcake(),this.game.dropManager.dropDonut(),this.game.dropTreat2Sound.play()):this.bonusCount>=10&&this.bonusCount<12?(this.game.dropManager.dropChocolateBar(),this.game.dropTreat2Sound.play()):this.bonusCount>=12&&this.bonusCount<14?(this.game.dropManager.dropCupcake(),this.game.dropManager.dropChocolateBar(),this.game.dropTreat2Sound.play()):this.bonusCount>=14&&this.bonusCount<16?(this.game.dropManager.dropChocolateBar(),this.game.dropManager.dropDonut(),this.game.dropTreat2Sound.play()):this.bonusCount>=16&&this.bonusCount<18?(this.game.dropManager.dropChocolateBar(),this.game.dropManager.dropCupcake(),this.game.dropManager.dropDonut(),this.game.dropTreat2Sound.play()):this.bonusCount>=16&&this.bonusCount<18&&(this.game.dropManager.dropPie(),this.game.dropTreat2Sound.play())}}class s{constructor(t,e,s){this.scene=t,this.game=s,this.materialManager=e,this.goal=new o(s),this.pusher=null,this.pusherSpeed=.25,this.pusherDirection=1,this.pusherLimitFront=-5,this.pusherLimitBack=-40}createCapturePlane(){const t=BABYLON.MeshBuilder.CreateGround("capturePlane",{width:200,height:200,depth:0},this.scene);return t.position.y=-55,t.position.z=48,t.physicsImpostor=new BABYLON.PhysicsImpostor(t,BABYLON.PhysicsImpostor.BoxImpostor,{mass:0,restitution:0,kinematic:!1},this.scene),t.physicsImpostor.registerOnPhysicsCollide(this.scene.getPhysicsEngine().getImpostors(),((t,e)=>{e.object.dispose()})),t.isVisible=!1,t}createGoalPlane(){const t=BABYLON.MeshBuilder.CreateGround("goalPlane",{width:40,height:50,depth:0},this.scene);return t.position.y=-45,t.position.z=90,t.isVisible=!1,t.physicsImpostor=new BABYLON.PhysicsImpostor(t,BABYLON.PhysicsImpostor.BoxImpostor,{mass:0,restitution:0,kinematic:!1},this.scene),t.physicsImpostor.registerOnPhysicsCollide(this.scene.getPhysicsEngine().getImpostors(),((t,e)=>{this.goal.checkGoal(e.object)})),t}loadPlatformModel(){BABYLON.SceneLoader.ImportMesh("","assets/","gamePlatform.glb",this.scene,(t=>{if(t.length>0){const e=t[0];e.name="gamePlatform",e.position=new BABYLON.Vector3(0,9,0),e.rotation=BABYLON.Vector3.Zero(),e.setPivotMatrix(BABYLON.Matrix.Translation(0,-e.scaling.y,0))}}))}createPusher(){const t=BABYLON.MeshBuilder.CreateBox("pusher",{width:40,height:10,depth:50},this.scene);return t.position.y=1,t.position.z=-25,t.material=this.materialManager.getMaterial("pusherMaterial"),t.physicsImpostor=new BABYLON.PhysicsImpostor(t,BABYLON.PhysicsImpostor.BoxImpostor,{mass:0,restitution:0,friction:1,kinematic:!0},this.scene),this.pusher=t,t}updatePusher(){this.pusher&&(this.pusher.position.z+=this.pusherSpeed*this.pusherDirection,(this.pusher.position.z>=this.pusherLimitFront||this.pusher.position.z<=this.pusherLimitBack)&&(this.pusherDirection*=-1))}}class i{constructor(t,e,o){this.game=e,this.scene=t,this.materialManager=o,this.wallDownPosition=-15,this.wallUpPosition=15,this.wallSpeed=.18,this.wallDirection=1,this.wallTimer=null,this.wallsUp=!1,this.wallTime=5e3,this.wallMoving=!1,this.frameRate=60,this.DesignWalls()}DesignWalls(){this.createWall({width:3,height:60,depth:60,position:{x:0,y:-20,z:110},rotation:{x:0,y:300,z:0}}).isVisible=!1,this.createWall({width:3,height:30,depth:20,position:{x:-27,y:-5,z:25},rotation:{x:.1,y:-Math.PI/4,z:Math.PI/10}}),this.createWall({width:3,height:30,depth:20,position:{x:27,y:-5,z:25},rotation:{x:.1,y:Math.PI/4,z:-Math.PI/10}}),this.rightWall=this.createWall({width:3,height:15,depth:40,position:{x:-22,y:this.wallDownPosition,z:47}}),this.leftWall=this.createWall({width:3,height:15,depth:40,position:{x:22,y:this.wallDownPosition,z:47}}),this.leftWall.mass=1,this.rightWall.mass=2,this.leftWallParent=new BABYLON.Mesh("leftWallParent",this.scene),this.rightWallParent=new BABYLON.Mesh("rightWallParent",this.scene),this.leftWallParent.addChild(this.leftWall),this.rightWallParent.addChild(this.rightWall),this.createWall({width:3,height:15,depth:40,position:{x:-23,y:-15,z:90}}),this.createWall({width:3,height:15,depth:40,position:{x:23,y:-15,z:90}}),this.createWall({width:3,height:15,depth:40,position:{x:0,y:-18,z:65},rotation:{x:0,y:300,z:0}})}createWall(t){const e=BABYLON.MeshBuilder.CreateBox("wall",{width:t.width,height:t.height,depth:t.depth},this.scene);return e.position.x=t.position.x,e.position.y=t.position.y+t.height/2,e.position.z=t.position.z,t.rotation&&(e.rotation.x=t.rotation.x||0,e.rotation.y=t.rotation.y||0,e.rotation.z=t.rotation.z||0),e.material=this.materialManager.getMaterial("collisionBoxMaterial"),e.physicsImpostor=new BABYLON.PhysicsImpostor(e,BABYLON.PhysicsImpostor.BoxImpostor,{mass:0,restitution:.1,friction:0}),e}raiseWallsWithTween(){if(!this.wallsUp){console.log("walls up!");const t=new BABYLON.Animation("raiseAnimation","position.y",this.frameRate,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT,BABYLON.Animation.EASINGMODE_EASEINOUT,this.wallRaised()),e=[];e.push({frame:0,value:0}),e.push({frame:this.frameRate,value:this.wallUpPosition}),t.setKeys(e),this.leftWallParent.animations.push(t),this.rightWallParent.animations.push(t),this.scene.beginAnimation(this.leftWallParent,0,this.frameRate,!1,this.wallSpeed),this.scene.beginAnimation(this.rightWallParent,0,this.frameRate,!1,this.wallSpeed)}}wallRaised(){console.log("Left wall animation finished."),this.wallsUp=!0,this.game.wallMoveFinishSound.play(),setTimeout((()=>{console.log("  lwals down !"),this.lowerWallsWithTween()}),this.wallTime)}lowerWallsWithTween(){if(this.wallsUp){console.log("walls down!"),console.log(this.leftWall.position.y),this.game.soundManager.wallMove.play();const t=new BABYLON.Animation("lowerAnimation","position.y",this.frameRate,BABYLON.Animation.ANIMATIONTYPE_FLOAT,BABYLON.Animation.ANIMATIONLOOPMODE_CYCLE),e=[];e.push({frame:0,value:this.wallUpPosition}),e.push({frame:this.frameRate,value:0}),t.setKeys(e),this.leftWallParent.animations.push(t),this.rightWallParent.animations.push(t),this.scene.beginDirectAnimation(this.leftWallParent,[t],0,this.frameRate,!1),this.scene.beginDirectAnimation(this.rightWallParent,[t],0,this.frameRate,!1),this.wallsUp=!1}}}class n{constructor(t,e,o){this.scene=t,this.materialManager=e,this.game=o,this.create(),this.walls=new i(this.scene,this.game,this.materialManager)}create(){const t=BABYLON.MeshBuilder.CreateBox("mainPlatform",{width:40,height:2,depth:100},this.scene);t.position.y=-1,t.position.z=20,t.material=this.materialManager.getMaterial("collisionBoxMaterial"),t.physicsImpostor=new BABYLON.PhysicsImpostor(t,BABYLON.PhysicsImpostor.BoxImpostor,{mass:0,restitution:0,friction:.05},this.scene);const e=BABYLON.MeshBuilder.CreateBox("backSlope",{width:3,height:90,depth:70},this.scene);e.position.x=0,e.position.y=10,e.rotation.y=Math.PI/2,e.position.z=-22,e.rotation.z=-Math.PI/10;const o=BABYLON.MeshBuilder.CreateBox("rightSlope",{width:3,height:90,depth:70},this.scene);o.position.x=-20,o.position.y=10,o.position.z=-15,o.rotation.z=Math.PI/10;const s=BABYLON.MeshBuilder.CreateBox("leftSlope",{width:3,height:90,depth:70},this.scene);s.position.x=20,s.position.y=10,s.position.z=-15,s.rotation.z=-Math.PI/10;const i={mass:0,restitution:.1,friction:0};return s.physicsImpostor=new BABYLON.PhysicsImpostor(s,BABYLON.PhysicsImpostor.BoxImpostor,i,this.scene),o.physicsImpostor=new BABYLON.PhysicsImpostor(o,BABYLON.PhysicsImpostor.BoxImpostor,i,this.scene),e.physicsImpostor=new BABYLON.PhysicsImpostor(e,BABYLON.PhysicsImpostor.BoxImpostor,i,this.scene),t}}class a{constructor(t,e,o,s){this.scene=t,this.materialManager=e,this.game=o}async initializeMasterCookie(){try{const t=await BABYLON.SceneLoader.ImportMeshAsync("","assets/","chocolateChipCookie.glb",this.scene);console.log("Loaded meshes:",t.meshes);const e=t.meshes.find((t=>"yourCookieMeshId"===t.id));e&&e.geometry?(this.masterCookie=e,this.masterCookie.isVisible=!1,this.masterCookie.setEnabled(!1)):console.error("No geometry found in the imported meshes")}catch(t){console.error("Error loading master cookie mesh:",t)}}async waitForPlatformImpostor(){for(;!this.game.platformImpostor;)await new Promise((t=>setTimeout(t,100)))}async createCookie(t,e,o,s){return o||(console.warn("Waiting for platform impostor to be ready..."),await this.platformImpostor),new Promise((async t=>{await new Promise((t=>{BABYLON.SceneLoader.ImportMesh("","assets/","sugarCookie.glb",this.scene,(i=>{if(i.length>0){const n=i[0];n.name="cookie",n.initialCollision=!0,n.position=new BABYLON.Vector3(0,17.2,0),n.rotation=BABYLON.Vector3.Zero(),n.setPivotMatrix(BABYLON.Matrix.Translation(0,-n.scaling.y,0)),n.scaling=new BABYLON.Vector3(14,18,14);const a=BABYLON.MeshBuilder.CreateCylinder("cookieCylinder",{height:2,diameterTop:7.5,diameterBottom:8,tessellation:12},this.scene);a.position=e,a.physicsImpostor=new BABYLON.PhysicsImpostor(a,BABYLON.PhysicsImpostor.CylinderImpostor,{mass:1,restitution:.5,friction:.05},this.scene),a.physicsImpostor.registerOnPhysicsCollide(o,((t,e)=>{n.initialCollision&&(this.game.thudSound.play(),n.initialCollision=!1)})),a.physicsImpostor.registerOnPhysicsCollide(s,((t,e)=>{n.initialCollision&&(this.game.thudSound.play(),n.initialCollision=!1)})),n.parent=a,a.isVisible=!1,t(n)}}))})),t()}))}createDonut(){BABYLON.SceneLoader.ImportMesh("","assets/","pinkDonut.glb",this.scene,(t=>{if(t.length>0){const e=t[0];e.name="donut",e.position=new BABYLON.Vector3(0,9,0),e.rotation=BABYLON.Vector3.Zero(),e.setPivotMatrix(BABYLON.Matrix.Translation(0,-e.scaling.y,0)),e.scaling=new BABYLON.Vector3(10,10,10);const o=BABYLON.MeshBuilder.CreateCylinder("donutCylinder",{height:6,diameterTop:1.6*e.scaling.x,diameterBottom:1.7*e.scaling.x,tessellation:12},this.scene);o.position=new BABYLON.Vector3(0,40,0),e.parent=o,o.physicsImpostor=new BABYLON.PhysicsImpostor(o,BABYLON.PhysicsImpostor.CylinderImpostor,{mass:3,restitution:.1,friction:.1},this.scene),o.isVisible=!1}}))}createCupcake(){BABYLON.SceneLoader.ImportMesh("","assets/","cupcake.glb",this.scene,(t=>{if(t.length>0){const e=t[0];e.name="cupcake",e.position=new BABYLON.Vector3(0,13,0),e.rotation=BABYLON.Vector3.Zero(),e.setPivotMatrix(BABYLON.Matrix.Translation(0,-e.scaling.y,0)),e.scaling=new BABYLON.Vector3(10,10,10);const o=BABYLON.MeshBuilder.CreateCylinder("cupcakeCylinder",{height:10,diameterTop:1.3*e.scaling.x,diameterBottom:.8*e.scaling.x,tessellation:12},this.scene);o.position=new BABYLON.Vector3(0,40,0),e.parent=o,o.physicsImpostor=new BABYLON.PhysicsImpostor(o,BABYLON.PhysicsImpostor.CylinderImpostor,{mass:2,restitution:.1,friction:.05},this.scene),o.isVisible=!1}}))}createChocolateBar(){BABYLON.SceneLoader.ImportMesh("","assets/","chocolateBar.glb",this.scene,(t=>{if(t.length>0){const e=t[0];e.name="chocolateBar",e.position=new BABYLON.Vector3(0,9,0),e.rotation=BABYLON.Vector3.Zero(),e.setPivotMatrix(BABYLON.Matrix.Translation(0,-e.scaling.y,0)),e.scaling=new BABYLON.Vector3(10,10,10);const o=BABYLON.MeshBuilder.CreateBox("chocolateBarBox",{height:1.5,width:17,depth:7},this.scene);o.position=new BABYLON.Vector3(0,40,0),e.parent=o,o.physicsImpostor=new BABYLON.PhysicsImpostor(o,BABYLON.PhysicsImpostor.BoxImpostor,{mass:2.4,restitution:.05,friction:.07},this.scene),o.isVisible=!1}}))}createPie(){BABYLON.SceneLoader.ImportMesh("","assets/","pie.glb",this.scene,(t=>{if(t.length>0){const e=t[0];e.name="pie",e.position=new BABYLON.Vector3(0,9,0),e.rotation=BABYLON.Vector3.Zero(),e.setPivotMatrix(BABYLON.Matrix.Translation(0,-e.scaling.y,0)),e.scaling=new BABYLON.Vector3(10,10,10);const o=this.createPieCollisionBox();o.position=new BABYLON.Vector3(0,40,0),e.parent=o,o.physicsImpostor=new BABYLON.PhysicsImpostor(o,BABYLON.PhysicsImpostor.BoxImpostor,{mass:2.4,restitution:.05,friction:.07},this.scene)}}))}createPieCollisionBox(){const t=BABYLON.MeshBuilder.CreateBox("box1",{height:1.5,width:10,depth:10},this.scene);t.position=new BABYLON.Vector3(0,0,0);const e=BABYLON.MeshBuilder.CreateBox("box2",{height:1.5,width:10,depth:10},this.scene);e.position=new BABYLON.Vector3(5,0,0),e.rotation.y=Math.PI/3;const o=BABYLON.MeshBuilder.CreateBox("box3",{height:1.5,width:10,depth:10},this.scene);o.position=new BABYLON.Vector3(-5,0,0),o.rotation.y=-Math.PI/3;const s=BABYLON.Mesh.MergeMeshes([t,e,o],!0,!0,void 0,!1,!0);return s.position=new BABYLON.Vector3(0,9,0),s.physicsImpostor=new BABYLON.PhysicsImpostor(s,BABYLON.PhysicsImpostor.BoxImpostor,{mass:2.4,restitution:.05,friction:.07},this.scene),s}}class r{constructor(t,e,o,s,i){this.scene=t,this.game=s,this.materialManager=e,this.loadedMonkeyModel=null,this.scaleFactor=2,this.platformImpostor=o,this.pusher=i,this.objects=new a(this.scene,this.materialManager,this.game)}loadMonkeyModel(){BABYLON.SceneLoader.ImportMesh("","assets/","monkey.glb",this.scene,(t=>{t.length>0&&(this.loadedMonkeyModel=t[0],this.loadedMonkeyModel.isVisible=!1,this.loadedMonkeyModel.scaling=new BABYLON.Vector3(this.scaleFactor,this.scaleFactor,this.scaleFactor))}))}dropMonkeyModel(){if(this.loadedMonkeyModel){const t=this.loadedMonkeyModel.clone("monkeyClone");t.isVisible=!0,t.position=new BABYLON.Vector3(0,40,110);const e=BABYLON.MeshBuilder.CreateBox("boundingBox",{width:2*this.scaleFactor,height:2*this.scaleFactor,depth:2*this.scaleFactor},this.scene);return e.isVisible=!1,e.position=t.position,e.physicsImpostor=new BABYLON.PhysicsImpostor(e,BABYLON.PhysicsImpostor.BoxImpostor,{mass:1,restitution:.1},this.scene),e.addChild(t),e}}dropCookie(t,e){const o=this.objects.createCookie(t,e,this.platformImpostor,this.pusher);if(!this.droppingCookies)return this.droppingCookies=!0,o.then((t=>{this.droppingCookies=!1})).catch((t=>{console.error(t),this.droppingCookies=!1})),o}dropDonut(){return this.objects.createDonut()}dropCupcake(){return this.objects.createCupcake()}dropChocolateBar(){return this.objects.createChocolateBar()}dropPie(){return this.objects.createPie()}dropCola(){return this.objects.createCola()}dropCake(){return this.objects.createCake()}}class h{constructor(t,e,o,s){this.scene=t,this.materialManager=e,this.dropManager=o,this.game=s,this.maxDrops=6,this.availableDrops=this.maxDrops,this.dropCooldown=1e3,this.cooldownTimer=null,this.coinPipeSpeed=.25,this.coinPipeLimit=20,this.coinPipeDirection=1,this.createCoinPipe(),this.game.uiManager.updateDropCounter(this.availableDrops),this.game.uiManager.updateCookieCounter(this.cookieCount)}createCoinPipe(){this.coinPipe=BABYLON.MeshBuilder.CreateCylinder("coinPipe",{height:30,diameter:10},this.scene),this.coinPipe.position=new BABYLON.Vector3(0,50,0),this.coinPipe.material=this.materialManager.getMaterial("someMaterial")}updateCoinPipe(){this.coinPipe.position.x+=this.coinPipeSpeed*this.coinPipeDirection,(this.coinPipe.position.x>this.coinPipeLimit||this.coinPipe.position.x<-this.coinPipeLimit)&&(this.coinPipeDirection*=-1)}dropCoinFromPipe(){if(this.availableDrops>0&&this.game.cookieCount>0){var t=new BABYLON.Vector3(this.coinPipe.position.x,this.coinPipe.position.y-16,this.coinPipe.position.z);this.dropManager.dropCookie(!0,t),this.game.poofSound.play(),this.consumeDrop(),this.game.cookieCount-=1,this.game.uiManager.updateCookieCounter(this.game.cookieCount)}}consumeDrop(){this.availableDrops-=1,this.game.uiManager.updateDropCounter(this.availableDrops),clearTimeout(this.cooldownTimer),this.cooldownTimer=setTimeout((()=>{this.incrementDrop()}),this.dropCooldown)}incrementDrop(){this.availableDrops<this.maxDrops&&(this.availableDrops+=1,this.game.uiManager.updateDropCounter(this.availableDrops),this.cooldownTimer=setTimeout((()=>{this.incrementDrop()}),500))}resetDrops(){this.availableDrops=this.maxDrops,this.game.uiManager.updateDropCounter(this.availableDrops)}}class l{constructor(t,e){this.scene=t,this.game=e,this.level=1}levelSystem(t){for(let e=0;e<2;e++){const e=1,o=3,s=7.8,i=-o/2*s+3.5,n=22,a=40,r=[],h=(l,c)=>{const u=i+c*s,p=n+l*s,d=new BABYLON.Vector3(u,a,p),m=this.game.dropManager.dropCookie(!1,d);if(m&&(m.rotation=BABYLON.Vector3.Zero(),r.push(m)),l<e-1||c<o-1)c<o-1?h(l,c+1):h(l+1,0);else{const e=5,o=5,s=8.8,i=-o/2*s+3.5,n=32,h=(l,c)=>{const u=i+c*s,p=n+l*s,d=new BABYLON.Vector3(u,a,p),m=this.game.dropManager.dropCookie(!1,d);m&&(m.rotation=BABYLON.Vector3.Zero(),r.push(m)),l<e-1||c<o-1?c<o-1?h(l,c+1):h(l+1,0):t(r)};h(0,0)}};h(0,0)}}}class c{constructor(t){this.game=t,this.sugarCounterElement=document.createElement("div"),this.sugarCounterElement.id="sugarCounter",this.scoreCounterElement=document.createElement("div"),this.scoreCounterElement.id="scoreCounter",this.dropCounterElement=document.createElement("div"),this.dropCounterElement.id="dropCounter",document.body.appendChild(this.dropCounterElement),document.body.appendChild(this.sugarCounterElement),document.body.appendChild(this.scoreCounterElement),this.cookieCounterElement=document.createElement("div"),this.cookieCounterElement.id="cookieCounter",document.body.appendChild(this.cookieCounterElement),this.cupcakeCounterElement=document.createElement("div"),this.cupcakeCounterElement.id="cupcakeCounter",document.body.appendChild(this.cupcakeCounterElement),this.donutCounterElement=document.createElement("div"),this.donutCounterElement.id="donutCounter",document.body.appendChild(this.donutCounterElement),this.chocolateCounterElement=document.createElement("div"),this.chocolateCounterElement.id="chocolateCounter",document.body.appendChild(this.chocolateCounterElement),this.updateScore(),this.updateSugarCounter(),this.updateDropCounter(6),this.updateCookieCounter(this.game.cookieCount),this.updateCupcakeCounter(this.game.cupcakeCount),this.updateDonutCounter(this.game.donutCount),this.updateChocolateCounter(this.game.chocolateCount)}updateSugarCounter(){this.sugarCounterElement.textContent=`Sugar: ${this.game.sugar}`}updateScore(){console.log("updateScore ",this.game.score),this.scoreCounterElement.textContent=`Score: ${this.game.score}`}updateDropCounter(t){this.dropCounterElement.textContent=`Drops: ${t}/6`}updateCookieCounter(){this.cookieCounterElement.textContent=`Cookies: ${this.game.cookieCount}`}updateCupcakeCounter(){this.cupcakeCounterElement.textContent=`Cupcakes: ${this.game.cupcakeCount}`}updateDonutCounter(){this.donutCounterElement.textContent=`Donuts: ${this.game.donutCount}`}updateChocolateCounter(){this.chocolateCounterElement.textContent=`${this.game.chocolateCount}`}}class u{constructor(t){this.game=t,this.initSound()}initSound(){this.game.wallMoveSound=new BABYLON.Sound("wallMove","../assets/sound/wallMove.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.wallMoveFinishSound=new BABYLON.Sound("wallMoveFinish","../assets/sound/wallMoveFinish.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.clickSound=new BABYLON.Sound("click","../assets/sound/click.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.thudSound=new BABYLON.Sound("thud","../assets/sound/thud.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.getSound=new BABYLON.Sound("get","../assets/sound/get.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.getTreatSound=new BABYLON.Sound("get","../assets/sound/getTreat.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.dropTreatSound=new BABYLON.Sound("get","../assets/sound/dropTreat.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.dropTreat2Sound=new BABYLON.Sound("get","../assets/sound/dropTreat2.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.poofSound=new BABYLON.Sound("get","../assets/sound/poof.mp3",this.scene,{autoplay:!1,volume:.5,loop:!1}),this.game.get1Sound=new BABYLON.Sound("get1","../assets/sound/get1.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get2Sound=new BABYLON.Sound("get2","../assets/sound/get2.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get3Sound=new BABYLON.Sound("get3","../assets/sound/get3.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get4Sound=new BABYLON.Sound("get4","../assets/sound/get4.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get5Sound=new BABYLON.Sound("get5","../assets/sound/get5.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get6Sound=new BABYLON.Sound("get6","../assets/sound/get6.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get7Sound=new BABYLON.Sound("get7","../assets/sound/get7.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get8Sound=new BABYLON.Sound("get8","../assets/sound/get8.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get9Sound=new BABYLON.Sound("get9","../assets/sound/get9.mp3",this.scene,{autoplay:!1,volume:1,loop:!1}),this.game.get10Sound=new BABYLON.Sound("get10","../assets/sound/get10.mp3",this.scene,{autoplay:!1,volume:1,loop:!1})}}class p{constructor(t){this.game=t,this.init(),this.clicks=0,this.clicksToMakeCookie=8}init(){}makeCookie(){this.clicks++,this.clicks>=this.clicksToMakeCookie&&(this.game.cookieCount++,this.clicks=0,this.game.uiManager.updateCookieCounter()),console.log("CLICK!")}}new class{constructor(o){const i=document.getElementById("startButton");i&&i.addEventListener("click",(()=>{this.startGame()})),window.addEventListener("click",(()=>{this.thudSound.play(),this.thudSound.pause()}),{once:!0}),window.addEventListener("keydown",(t=>this.onKeyDown(t))),this.canvas=document.getElementById(o),this.engine=new BABYLON.Engine(this.canvas,!0,{antialias:!0,allowSleep:!0,sleepTimeLimit:2}),this.cookieCount=50,this.cupcakeCount=0,this.donutCount=0,this.chocolateCount=0,this.score=0,this.sugar=0,this.wallTokens=100,this.wallsUp=!1,this.wallsDown=!1,this.sceneManager=new t(this.engine,this.canvas),this.scene=this.sceneManager.getScene(),this.uiManager=new c(this),this.cookieMaker=new p(this),this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.jingle2=[261.63,293.66,329.63,349.23,392,440,493.88,523.25],this.SoundManager=new u(this),this.materialManager=new e(this.scene),this.gameObjectManager=new s(this.scene,this.materialManager,this),this.platform=new n(this.scene,this.materialManager,this);const a=this.platform.create().physicsImpostor,d=this.gameObjectManager.createPusher().physicsImpostor;this.gameObjectManager.createGoalPlane(),this.gameObjectManager.createCapturePlane(),this.gameObjectManager.loadPlatformModel(),this.dropManager=new r(this.scene,this.materialManager,a,this,d),this.coinPipeManager=new h(this.scene,this.materialManager,this.dropManager,this),this._startGameLoop(),this._setupButtons(),new l(this.scene,this).levelSystem((t=>{}))}doAThing(){console.log("did a thing")}onKeyDown(t){console.log("onKeyDown onKeyDown"),"q"===t.key&&(this.thudSound.play(),this.getSound.play())}_startGameLoop(){this.engine.runRenderLoop((()=>{this.gameObjectManager.updatePusher(),this.coinPipeManager.updateCoinPipe(),this.scene.render()}))}playClickTone(t){const e=this.jingle2.shift(),o=this.audioContext.createOscillator();o.type="triangle",o.frequency.setValueAtTime(e,this.audioContext.currentTime),o.connect(this.audioContext.destination),o.start(),o.stop(this.audioContext.currentTime+.5),this.jingle2.push(e)}_setupButtons(){const t=document.getElementById("dropCookieButton");t&&t.addEventListener("click",(()=>{this.coinPipeManager.dropCoinFromPipe(!0)}));const e=document.getElementById("makeCookieButton");e&&e.addEventListener("click",(()=>{this.cookieMaker.makeCookie(),this.clickSound.play()}));const o=document.getElementById("dropDonutButton");o&&o.addEventListener("click",(()=>{this.dropManager.dropDonut()}));const s=document.getElementById("dropCupcakeButton");s&&s.addEventListener("click",(()=>{this.dropManager.dropCupcake()}));const i=document.getElementById("dropChocolateBarButton");i&&i.addEventListener("click",(()=>{this.dropManager.dropChocolateBar()}));const n=document.getElementById("dropPieButton");n&&n.addEventListener("click",(()=>{this.dropManager.dropPie()}));const a=document.getElementById("wallButton");a&&a.addEventListener("click",(()=>{this.platform.walls.wallsUp||(this.wallMoveSound.play(),this.platform.walls.raiseWallsWithTween(),setTimeout((()=>{console.log("walls setTimeout!"),this.platform.walls.wallRaised()}),this.platform.walls.wallTime))}));const r=document.getElementById("toggleCameraLockButton");r&&r.addEventListener("click",(()=>{this.sceneManager.cameraLock()}))}}("renderCanvas")})();